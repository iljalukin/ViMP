var VimpObserver={mid:0,time_ranges:[],send_request:!1,init:function(a,b){VimpObserver.mid=a,VimpObserver.time_ranges=b,window.setInterval(VimpObserver.observe,5e3)},observe:function(){VimpObserver.send_request=!1;for(var a=$("video")[0].played,b=0,c=[];b<a.length;)c.push({s:a.start(b),e:a.end(b)}),b++;VimpObserver.merge_ranges(c);!1===VimpObserver.send_request||$.post({url:VimpContent.ajax_base_url+"&cmd=updateProgress",data:{mid:VimpObserver.mid,ranges:JSON.stringify(VimpObserver.time_ranges)}}).always(function(a){console.log(a)})},merge_ranges:function(a){a.forEach(function(a){VimpObserver.merge_single(a)})},merge_single:function(a){var b=0;VimpObserver.time_ranges.forEach(function(c,d){var e=Math.max,f=Math.min;if(1!=b&&VimpObserver.overlap(c,a)){if(b=1,VimpObserver.contains(c,a))return;VimpObserver.send_request=!0,VimpObserver.time_ranges[d]={s:f(a.s,c.s),e:e(a.e,c.e)},VimpObserver.merge_ranges(VimpObserver.time_ranges.splice(d,1))}}),0==b&&(VimpObserver.send_request=!0,VimpObserver.time_ranges.push(a))},overlap:function(c,a){return c.s<=a.e&&a.s<=c.e},contains:function(c,a){return a.s>=c.s&&a.e<=c.e}};